---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allArticles = await getCollection('articles');
const publishedArticles = allArticles
  .filter(article => !article.data.draft)
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());

function formatDate(date: Date): string {
  return new Intl.DateTimeFormat('en-GB', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  }).format(date);
}
---

<Layout
  title="Member Resources"
  description="Articles, guides, and resources for Sheffield Speakers Toastmasters club members."
>
  <section class="py-16 bg-gray-50 min-h-[calc(100vh-200px)]">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <h1 class="font-heading text-4xl md:text-5xl font-bold mb-4 text-loyal-blue">
          Member Resources
        </h1>
        <p class="font-body text-lg text-gray-700 mb-12">
          Articles, guides, and tips to support your Toastmasters journey.
        </p>

        {publishedArticles.length === 0 ? (
          <div class="bg-white p-8 rounded-lg shadow-sm text-center">
            <p class="font-body text-gray-600">
              No articles have been published yet. Check back soon!
            </p>
          </div>
        ) : (
          <div class="space-y-6">
            {publishedArticles.map((article) => (
              <article class="bg-white p-6 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                <a href={`/resources/${article.slug}`} class="group">
                  <h2 class="font-heading text-2xl font-bold mb-2 text-loyal-blue group-hover:text-true-maroon transition-colors">
                    {article.data.title}
                  </h2>
                  <div class="flex flex-wrap gap-3 text-sm text-gray-600 mb-3 font-body">
                    <span>By {article.data.author}</span>
                    <span>•</span>
                    <time datetime={article.data.publishDate.toISOString()}>
                      {formatDate(article.data.publishDate)}
                    </time>
                  </div>
                  <p class="font-body text-gray-700 mb-4">
                    {article.data.description}
                  </p>
                  <span class="text-true-maroon font-semibold font-body group-hover:underline">
                    Read more →
                  </span>
                </a>
              </article>
            ))}
          </div>
        )}
      </div>
    </div>
  </section>
</Layout>
